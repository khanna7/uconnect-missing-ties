```r

## Analysis of Respondent-Only Network
## Aditya Khanna
## Put code to share here
```

[Reference](http://mailman13.u.washington.edu/pipermail/statnet_help/2013/001528.html) on gwdsp, and gwesp

``` r
library(ergm)
library(network)
library(ggplot2)
```

```r
## data
rm(list=ls())
load("R0_net_wattributes_identified.RData")
```

### Respondent-Only Network

```r
## Respondent-Only Network
R0.net

 Network attributes:
  vertices = 302 
  directed = FALSE 
  hyper = FALSE 
  loops = FALSE 
  multiple = FALSE 
  bipartite = FALSE 
  total edges= 3273 
    missing edges= 0 
    non-missing edges= 3273 

 Vertex attribute names: 
    vertex.names 

 Edge attribute names not shown 
```

#### Degree Distribution
```r
## Degree Distribution
R0.deg <- degreedist(R0.net)
pdf(file="r0_deg_dist.pdf")
plot(R0.deg, type="l", xlab="Degree", ylab="Frequency")
dev.off()
```

See degree distribution [here](https://github.com/khanna7/UConect_MissingTies/blob/master/r0_deg_dist.pdf)


#### Edges-Only Model
```r
edges.mod <- ergm(R0.net ~ edges, verbose=TRUE)
edges.mod.deg.gof <- gof(edges.mod ~ degree)
edges.mod.esp.gof <- gof(edges.mod ~ esp)

pdf(file="edgesonly_deg.pdf")
plot(edges.mod.deg.gof)
dev.off()

pdf(file="edgesonly_esp.pdf")
plot(edges.mod.esp.gof)
dev.off()
```

In Edges-only model, fit to [degree](https://github.com/khanna7/UConect_MissingTies/blob/master/edgesonly_deg.pdf), and fit to [esp](https://github.com/khanna7/UConect_MissingTies/blob/master/edgesonly_esp.pdf). Model converged.

#### Edges+Triangle Model
```r
triangle.mod <- ergm(R0.net ~ edges+triangle)
mcmc.diagnostics(triangle.mod)
triangle.deg.gof <- gof(triangle.mod~degree)
triangle.esp.gof <- gof(triangle.mod~esp)

pdf(file="gof_triangle_degree.pdf")
plot(triangle.deg.gof)
dev.off()

pdf(file="gof_triangle_esp.pdf")
plot(triangle.esp.gof)
dev.off()
````

In Edges+Triangle model, fit to [degree](https://github.com/khanna7/UConect_MissingTies/blob/master/gof_triangle_degree.pdf), and fit to [esp](https://github.com/khanna7/UConect_MissingTies/blob/master/gof_triangle_degree.pdf). Model converged, but it is [degenerate](https://github.com/khanna7/UConect_MissingTies/blob/master/mcmc_edges_triangle.png).

#### Gwesp model
```r
gwesp.mod <- ergm(R0.net ~ 
                  edges+gwesp(7, fixed=FALSE),
                  verbose=TRUE,
                  )
                  
summary(gwesp.mod)

==========================
Summary of model fit
==========================

Formula:   R0.net ~ edges + gwesp(7, fixed = FALSE)

Iterations:  20 

Monte Carlo MLE Results:
             Estimate Std. Error MCMC % p-value    
edges        -3.77555    0.03980      0  <1e-04 ***
gwesp         0.06367  220.93923      0  0.9998    
gwesp.alpha   7.00000    3.16799      0  0.0271 *  
---
Signif. codes:  0  ***  0.001  **  0.01  *  0.05  .  0.1     1

     Null Deviance:   63008  on 45451  degrees of freedom
 Residual Deviance: 3192998  on 45448  degrees of freedom
                  

```
Dignostics: [MCMC](https://github.com/khanna7/UConect_MissingTies/blob/master/mcmc_gwesp_alpha7.pdf); GOFs: [degree](https://github.com/khanna7/UConect_MissingTies/blob/master/gwesp_alpha7_deg_gof.pdf), [esp](https://github.com/khanna7/UConect_MissingTies/blob/master/gwesp_alpha7_esp_gof.pdf)
